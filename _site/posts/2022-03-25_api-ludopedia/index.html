<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Nicholas Marino">
<title>Nicholas Marino - Interagindo com a API da Ludopedia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../books.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script><link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Nicholas Marino - Interagindo com a API da Ludopedia">
<meta name="twitter:description" content="Neste post eu mostro como interagir com a API da Ludopedia para adquirir os dados dos jogos de tabuleiro disponíveis nesse portal. Veremos que o processo é diferente daquele que usamos para explorar a API do BoardGameGeek, apesar das informações obtidas serem bastante similares. Este post servirá de referência para outras ideias que vamos desenvolver no futuro.">
<meta name="twitter:image" content="https://nacmarino.netlify.app/posts/2022-03-25_api-ludopedia/images/logo_ludopedia.png">
<meta name="twitter:image-height" content="726">
<meta name="twitter:image-width" content="636">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Nicholas Marino</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Procurar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Alternar de navegação" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">Sobre</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-autor" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Autor</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-autor">
<li>
    <a class="dropdown-item" href="../../cv.html" rel="" target="">
 <span class="dropdown-text">CV</span></a>
  </li>  
    </ul>
</li>
</ul>
<div class="quarto-navbar-tools">
    <a href="https://github.com/nacmarino/blog" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Alternar modo de leitor">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Interagindo com a API da Ludopedia</h1>
            <p class="subtitle lead"></p>
<p>Neste post eu mostro como interagir com a API da Ludopedia para adquirir os dados dos jogos de tabuleiro disponíveis nesse portal. Veremos que o processo é diferente daquele que usamos para explorar a API do BoardGameGeek, apesar das informações obtidas serem bastante similares. Este post servirá de referência para outras ideias que vamos desenvolver no futuro.</p>
                                <div class="quarto-categories">
                <div class="quarto-category">web scraping</div>
                <div class="quarto-category">boardgames</div>
                <div class="quarto-category">r</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Autor</div>
      <div class="quarto-title-meta-contents">
               <p><a href="nacmarino.netlify.app">Nicholas Marino</a> <a href="https://orcid.org/0000-0002-5702-5466" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Data de Publicação</div>
      <div class="quarto-title-meta-contents">
        <p class="date">25 de março de 2022</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Data de Modificação</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">12 de fevereiro de 2024</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Conteudo</h2>
   
  <ul>
<li><a href="#motiva%C3%A7%C3%A3o" id="toc-motivação" class="nav-link active" data-scroll-target="#motiva%C3%A7%C3%A3o">Motivação</a></li>
  <li>
<a href="#autentica%C3%A7%C3%A3o" id="toc-autenticação" class="nav-link" data-scroll-target="#autentica%C3%A7%C3%A3o">Autenticação</a>
  <ul class="collapse">
<li><a href="#criando-o-aplicativo" id="toc-criando-o-aplicativo" class="nav-link" data-scroll-target="#criando-o-aplicativo">Criando o Aplicativo</a></li>
  <li><a href="#pegando-o-token" id="toc-pegando-o-token" class="nav-link" data-scroll-target="#pegando-o-token">Pegando o Token</a></li>
  </ul>
</li>
  <li>
<a href="#interagindo-com-a-api" id="toc-interagindo-com-a-api" class="nav-link" data-scroll-target="#interagindo-com-a-api">Interagindo com a API</a>
  <ul class="collapse">
<li><a href="#pegando-a-lista-de-jogos" id="toc-pegando-a-lista-de-jogos" class="nav-link" data-scroll-target="#pegando-a-lista-de-jogos">Pegando a lista de jogos</a></li>
  <li><a href="#pegando-as-informa%C3%A7%C3%B5es-de-um-jogo" id="toc-pegando-as-informações-de-um-jogo" class="nav-link" data-scroll-target="#pegando-as-informa%C3%A7%C3%B5es-de-um-jogo">Pegando as informações de um jogo</a></li>
  <li><a href="#outros-usos-da-api" id="toc-outros-usos-da-api" class="nav-link" data-scroll-target="#outros-usos-da-api">Outros usos da API</a></li>
  </ul>
</li>
  <li><a href="#dicion%C3%A1rio-de-dados" id="toc-dicionário-de-dados" class="nav-link" data-scroll-target="#dicion%C3%A1rio-de-dados">Dicionário de Dados</a></li>
  <li><a href="#conclus%C3%B5es" id="toc-conclusões" class="nav-link" data-scroll-target="#conclus%C3%B5es">Conclusões</a></li>
  <li><a href="#poss%C3%ADveis-extens%C3%B5es" id="toc-possíveis-extensões" class="nav-link" data-scroll-target="#poss%C3%ADveis-extens%C3%B5es">Possíveis Extensões</a></li>
  </ul></nav>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content"><section id="motivação" class="level1"><h1>Motivação</h1>
<p>Ao longo dos últimos posts, apresentei alguns <em>scrappers</em> e <a href="https://nacmarino.netlify.app/posts/2021-12-11_notas-boardgames/">análises</a> baseadas nos dados disponíveis em dois portais de jogos de tabuleiro: o <a href="https://nacmarino.netlify.app/posts/2021-09-17_scrapper-boardgamegeek/">BoardGameGeek</a> e a <a href="https://nacmarino.netlify.app/posts/2021-10-24_scrapper-ludopedia/">Ludopedia</a>. Tudo o que foi desenvolvido focou muito nos rankings daqueles portais mas, recentemente, mostrei como podemos obter dados mais interessantes do que estes através da <a href="https://nacmarino.netlify.app/posts/2022-01-23_api-boardgamegeek/">API XML do BoardGameGeek</a>. A Ludopedia também oferece dados similares a esses, e que podem ser acessados através de uma REST API disponibilizada pelo portal. Assim, poderíamos usar essas APIs para obter o mesmo tipo de informação entre portais distintos, abrindo a possibilidade de desenvolvermos análises comparativas mais aprofundadas do que àquelas que já fizemos e explorar outras possibilidades.</p>
<p>Este post mostrará o passo a passo de como interagir com a REST API da Ludopedia. Esta é uma API que necessita de autenticação OAUTH 2.0 e, portanto, começaremos mostrando como fazer esta autenticação. Na sequência, veremos como usar os <em>endpoints</em> da API para extrair a lista de jogos e os metadados associados a eles. Com isso, espero que este post ilustre os tipos de dados que teremos à nossa disposição, além de servir de referência para a aquisição e tratamento dos dados da Ludopedia em posts futuros. Vamos ao trabalho!</p>
</section><section id="autenticação" class="level1"><h1>Autenticação</h1>
<p>Como já comentamos, a Ludopedia oferece uma REST API que faz uso de autenticação OAUTH 2.0, fazendo com que tenhamos que ter um token de acesso para que possamos passar as requisições para a API. O processo de autenticação e o uso dos <em>endpoints</em> da API é bem documentada, e pode ser acessada através deste <a href="https://ludopedia.com.br/api/documentacao.html">link</a>. No geral, a obtenção do token de acesso passa por duas etapas: a primeira é a criação de um aplicativo no site da Ludopedia que ficará responsável por gerar o token de acesso, e a segunda é a requisição do mesmo. Como tive bastante dificuldade em fazer sentido do encadeamento das etapas deste processo, vou apresentá-los abaixo e mostrar como fazer essa autenticação através do R.</p>
<section id="criando-o-aplicativo" class="level2"><h2 class="anchored" data-anchor-id="criando-o-aplicativo">Criando o Aplicativo</h2>
<p>O primeiro passo para a utilização da API é a criação de um aplicativo no portal da Ludopedia, que pode ser feita por <a href="https://ludopedia.com.br/aplicativos">aqui</a>. Acredito que um pré-requisito para isso é que você tenha uma conta ativa no portal da Ludopedia, que pode ser criada gratuitamente e sem muito drama. Assumindo que você já tem essa conta, está logado no portal e tenha aberto o link acima, a página que você deve cair é àquela da figura abaixo. Para criar um aplicativo, não tem mistério: é só clicar no botão verde limão onde está escrito <strong>Novo Aplicativo</strong>.</p>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">magick</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/editing.html">image_read</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">'images/cria_app_passo_1.png'</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/cria_app_1-1.png" class="img-fluid" width="1470"></p>
</div>
</div>
<p>Assim que a página seguinte for carregada, você verá um formulário conforme aquele apresentado na figura abaixo. Apesar de existirem alguns campos que podem ser preenchidos, você só precisa focar em dois deles:</p>
<ul>
<li>
<strong>Nome do Aplicativo</strong>, que será o nome que você dará para este aplicativo; e,</li>
<li>
<strong>URI de Retorno de Autorização (Redirect URI)</strong>, que será a <em>url</em> para a qual o usuário do aplicativo será redirecionado após ter o acesso aprovado. Das coisas que pesquisei por aí, resolvi usar <code>http://localhost:1410/</code>.</li>
</ul>
<p>Depois de preencher aqueles dois campos, basta clicar no <em>checkbox</em> para concordar com o termos de uso e, então, clicar em <strong>Gravar</strong>.</p>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">magick</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/editing.html">image_read</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">'images/cria_app_passo_2.png'</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/cria_app_2-1.png" class="img-fluid" width="1446"></p>
</div>
</div>
<p>Se tudo tiver dado certo, você deverá ser levado de volta à página inicial da criação do aplicativo, mas agora perceberá que existem algumas informações adicionais. Duas delas foi você quem definiu - o nome do aplicativo (<code>APP</code>) e a URI de redirecionamento (<code>URIs</code>) -, enquanto as outras três vêm da criação do aplicativo mesmo. Destas, já temos de cara o token de acesso (<code>ACESS_TOKEN (Usuário)</code>) que pode ser guardado e usado diretamente para fazer as requisições à API (com um detalhe importante que já falaremos). A outra informação importante para se guardar é àquela do <code>APP_ID</code>, que será usada para fazer a autenticação de forma programática no R.</p>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">magick</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/editing.html">image_read</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">'images/cria_app_passo_3.png'</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/cria_app_3-1.png" class="img-fluid" width="1460"></p>
</div>
</div>
<p>Com isso, fechamos a criação do aplicativo que nos dá acesso à API. Se quisermos consumir os dados da API, basta usar o header <code>AUTHORIZATION</code> nas requisições dos <em>endpoints</em>, passando um <em>string</em> que será composto pela palavra <code>Bearer</code>, um espaço, e o código do token de acesso (<em>e.g.</em>, <code>Bearer &lt;token_de_acesso&gt;</code>). Se, por outro lado, forem outras pessoas que usarão seu aplicativo, então precisaremos ter uma forma de entregar esse token de acesso à elas. É à essa tarefa que vamos passar agora.</p>
</section><section id="pegando-o-token" class="level2"><h2 class="anchored" data-anchor-id="pegando-o-token">Pegando o Token</h2>
<p>Ainda seguindo a documentação da API, e simplificando o que está escrito por lá, a aquisição de um token de acesso pelo usuário é feita pelo seu direcionamento para a <code>url</code> de autorização da API - <code>https://ludopedia.com.br/oauth</code> -, junto dos parâmetros <code>APP_ID</code> e <code>REDIRECT URI</code> que você obteve ao criar o aplicativo. Nessa parte, a documentação segue em frente para explicar mais um monte de coisas sobre a forma como a requisição deve ser feita, e que acaba ficando muito confusa. Entretanto, duas instruções são importantes: (1) uma vez que a autorização é feita, a requisição de acesso do token deve ser encaminhada para a <code>url</code> <code>https://ludopedia.com.br/tokenrequest/</code> e, como resposta, (2) essa <code>url</code> retornará um arquivo JSON com o token de acesso. Vamos operacionalizar este processo usando as funções disponíveis no pacote <code>httr</code>, onde:</p>
<ol type="1">
<li>Faremos uso função <code><a href="https://httr.r-lib.org/reference/oauth_endpoint.html">httr::oauth_endpoint</a></code> para definir os <em>endpoints</em> de autorização e requisição do token de acesso. Para isso, definiremos os argumentos <code>authorize = https://ludopedia.com.br/oauth</code> e <code>access = 'https://ludopedia.com.br/tokenrequest/'</code>, deixando o argumento <code>request</code> como <code>NULL</code>;<br>
</li>
<li>Usaremos a função <code><a href="https://httr.r-lib.org/reference/oauth_app.html">httr::oauth_app</a></code> para submeter as credenciais de acesso para a autenticação, o que nos trará como resultado a chave que trocaremos posteriormente pelo token de acesso. Essa função levará como argumentos o nome do aplicativo (<code>appname = &lt;nome do seu aplicativo&gt;</code>) e a URI de Retorno de Autorização (<code>redirect_uri = &lt;URI de retorno&gt;</code>) que você criou, além do <code>APP_ID</code> que foi gerado depois que você criou o aplicativo no portal da Ludopedia (<code>key = &lt;APP_ID do seu aplicativo&gt;</code>); e,<br>
</li>
<li>Usaremos a função <code><a href="https://httr.r-lib.org/reference/init_oauth2.0.html">httr::init_oauth2.0</a></code> para trocar a chave pelo token de acesso através dos <em>endpoints</em> que definimos. Essa função leva dois argumentos: o objeto criado no item 1 acima irá para o argumento <code>endpoint</code>, e o objeto do item 2 irá para o argumento <code>app</code>.</li>
</ol>
<p>Se tudo estiver certo, a função <code><a href="https://httr.r-lib.org/reference/init_oauth2.0.html">httr::init_oauth2.0</a></code> deve retornar um arquivo JSON (que você possivelmente visualizará como uma lista no R) onde um dos elementos é o <code>access_token</code>. Com isso, basta juntar este elemento com o <em>string</em> <code>Bearer</code> (que está dentro do elemento <code>token_type</code> no mesmo arquivo JSON), e teremos o token de acesso completo que deve ser usado nas requisições para a API. Falando nisso, vou usar a função que criamos abaixo para pegar o token de acesso que usaremos durante esse post.</p>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># carregando pacotes</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># core</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://jeroen.r-universe.dev/jsonlite">jsonlite</a></span><span class="op">)</span> <span class="co"># para arquivos json</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://httr.r-lib.org/">httr</a></span><span class="op">)</span> <span class="co"># para o scraping</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://fs.r-lib.org">fs</a></span><span class="op">)</span> <span class="co"># para mexer com paths</span></span>
<span></span>
<span><span class="co"># função para fazer a autenticacao do aplicativo</span></span>
<span><span class="va">pegar_access_token</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">APP</span>, <span class="va">APP_ID</span>, <span class="va">URIs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># setando o endpoint de acordo com os dados fornecidos na ludopedia</span></span>
<span>  <span class="va">ludopedia_endpoint</span> <span class="op">&lt;-</span> <span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/oauth_endpoint.html">oauth_endpoint</a></span><span class="op">(</span></span>
<span>    request <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    authorize <span class="op">=</span> <span class="st">'https://ludopedia.com.br/oauth/'</span>,</span>
<span>    access <span class="op">=</span> <span class="st">'https://ludopedia.com.br/tokenrequest/'</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># setando as configurações do aplicativo conforme definido no site da ludopedia</span></span>
<span>  <span class="va">ludopedia_app</span> <span class="op">&lt;-</span> <span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/oauth_app.html">oauth_app</a></span><span class="op">(</span></span>
<span>    appname <span class="op">=</span> <span class="va">APP</span>,</span>
<span>    key <span class="op">=</span> <span class="va">APP_ID</span>,</span>
<span>    secret <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    redirect_uri <span class="op">=</span> <span class="va">URIs</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># pegando a autorizacao através do OAUTH2.0</span></span>
<span>  <span class="va">autorizacao</span> <span class="op">&lt;-</span> <span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/init_oauth2.0.html">init_oauth2.0</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="va">ludopedia_endpoint</span>, </span>
<span>                                     app <span class="op">=</span> <span class="va">ludopedia_app</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># criando string do token</span></span>
<span>  <span class="va">access_token</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">autorizacao</span><span class="op">$</span><span class="va">token_type</span>, <span class="st">' '</span>, <span class="va">autorizacao</span><span class="op">$</span><span class="va">access_token</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># retornando o token de acesso</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">access_token</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># fazendo a autenticacao no portal</span></span>
<span><span class="va">meu_token</span> <span class="op">&lt;-</span> <span class="fu">pegar_access_token</span><span class="op">(</span></span>
<span>  APP <span class="op">=</span> <span class="st">'meu_app'</span>, </span>
<span>  APP_ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">'APP_ID'</span><span class="op">)</span>, </span>
<span>  URIs <span class="op">=</span> <span class="st">'http://localhost:1410/'</span></span>
<span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Coisas do <code>quarto</code>…
</div>
</div>
<div class="callout-body-container callout-body">
<p>O procedimento acima faz abrir uma janelinha no seu navegador para autorizar o acesso ao seu aplicativo. No entanto, o <code>quarto</code> não estava abrindo essa janela quando coloquei o post para renderizar. Não encontrei nada que pudesse explicar esse comportamento, tampouco algo que pudesse ajudar para deixar a função como ela estava anteriormente. Portanto, eu deixei o meu token <em>hard-coded</em> abaixo só por conta do post mesmo - mas se você for rodar o código linha a linha, o processo acima deve funcionar.</p>
</div>
</div>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># carregando pacotes</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># core</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://jeroen.r-universe.dev/jsonlite">jsonlite</a></span><span class="op">)</span> <span class="co"># para arquivos json</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://httr.r-lib.org/">httr</a></span><span class="op">)</span> <span class="co"># para o scraping</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://fs.r-lib.org">fs</a></span><span class="op">)</span> <span class="co"># para mexer com paths</span></span>
<span></span>
<span><span class="va">meu_token</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'Bearer '</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">'APP_TOKEN'</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="interagindo-com-a-api" class="level1"><h1>Interagindo com a API</h1>
<p>De posse do token de acesso, vamos explorar as funcionalidades da API da Ludopedia. A ideia aqui não é cobrir todos os <em>endpoints</em> disponíveis, mas apenas focar em um ou outro que serão importantes em posts futuros. Nesse contexto, trabalharemos com dois tipos principais de <em>enpoints</em>: aquele que retorna a lista dos jogos cadastrados no portal da Ludopedia e o outro que retorna os seus metadados. Vamos começar criando repositórios para armazenar cada uma das informações que formos trabalhando.</p>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## definindo os paths temporarios que serao usados</span></span>
<span><span class="va">path_para_jogos</span> <span class="op">&lt;-</span> <span class="st">'temporario_jogos'</span></span>
<span><span class="va">path_para_metadata</span> <span class="op">&lt;-</span> <span class="st">'temporario_metadados'</span></span>
<span></span>
<span><span class="co">## criando pasta para guardar a tabela com a lista de jogos</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://fs.r-lib.org/reference/file_access.html">dir_exists</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">path_para_jogos</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://fs.r-lib.org/reference/create.html">dir_create</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">path_para_jogos</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## criando pasta para guardar a tabela com os metadados dos jogos</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://fs.r-lib.org/reference/file_access.html">dir_exists</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">path_para_metadata</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://fs.r-lib.org/reference/create.html">dir_create</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">path_para_metadata</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="pegando-a-lista-de-jogos" class="level2"><h2 class="anchored" data-anchor-id="pegando-a-lista-de-jogos">Pegando a lista de jogos</h2>
<p>O primeiro <em>endpoint</em> que exploraremos é aquele que retorna a lista de jogos cadastrados no portal da Ludopedia. Para facilitar o uso deste <em>endpoint</em>, escrevi a função <code>pega_lista_jogos</code> abaixo, que já traz o endereço do <em>endpoint</em>, junto do <code>header</code> com o token de acesso (<em>i.e.</em>, <code>add_headers(AUTHORIZATION = access_token)</code>) e uma lista com os parâmetros da <em>query</em> que precisa ser feita. Embora hajam alguns parâmetros disponíveis para esta <em>query</em>, focaremos em dois deles aqui: <code>rows</code>, que define a quantidade máxima de jogos que teremos como resposta por requisição (o limite é naturalmente 100 jogos por requisição, mas decidi deixar isso claro na função), e <code>page</code>, que define a página da lista dos jogos cadastrados que buscaremos (mais sobre isso no outro parágrafo). Como de costume, salvamos o arquivo JSON que recebemos de resposta em disco, de forma a acessá-lo à qualquer outro momento sem ter que ficar repetindo a requisição.</p>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># função para pegar todos os jogos em uma dada página</span></span>
<span><span class="va">pegar_lista_jogos</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">pagina</span>, <span class="va">access_token</span>, <span class="va">path_salvar</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># pegando os jogos da pagina selecionada</span></span>
<span>  <span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/GET.html">GET</a></span><span class="op">(</span><span class="st">'https://ludopedia.com.br/api/v1/jogos'</span>, </span>
<span>            <span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/add_headers.html">add_headers</a></span><span class="op">(</span>AUTHORIZATION <span class="op">=</span> <span class="va">access_token</span><span class="op">)</span>,</span>
<span>            query <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fl">100</span>, page <span class="op">=</span> <span class="va">pagina</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://httr.r-lib.org/reference/write_disk.html">write_disk</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="va">path_salvar</span>, <span class="st">'/lista_jogos_pagina_{pagina}.json'</span><span class="op">)</span>,</span>
<span>                       overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># pegando a primeira pagina da lista de jogos</span></span>
<span><span class="va">lista</span> <span class="op">&lt;-</span> <span class="fu">pegar_lista_jogos</span><span class="op">(</span>pagina <span class="op">=</span> <span class="fl">1</span>, access_token <span class="op">=</span> <span class="va">meu_token</span>, path_salvar <span class="op">=</span> <span class="va">path_para_jogos</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>O parser do arquivo que recebemos não tem muito mistério. Precisaremos carregar o arquivo de resposta salvo em disco usando a função <code><a href="https://rdrr.io/pkg/jsonlite/man/read_json.html">jsonlite::read_json</a></code> e definindo o argumento <code>simplifyDataFrame = TRUE</code>, para estruturarmos tudo o que conseguirmos como um <code>data.frame</code>. O objeto resultante dessa operação será uma lista, onde o primeiro elemento, <code>jogos</code>, será a tabela com a lista dos 100 jogos disponíveis na primeira página da API. Focando neste elemento, precisaremos de mais um tratamento para passar o <code>data.frame</code> com a lista de jogos para um <code>tibble</code> e, eventuamente, colocá-la em um formato tal que não hajam <code>list-columns</code>.</p>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># função para parsear uma pagina contendo a lista de jogos cadastrados na base da Ludopedia</span></span>
<span><span class="va">parser_lista_jogos</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">target_path</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># carregando o arquivo json</span></span>
<span>  <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/read_json.html">read_json</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">target_path</span>, simplifyDataFrame <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># extraindo o elemento correspondente aos jogos</span></span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html">pluck</a></span><span class="op">(</span><span class="st">'jogos'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># colocando como tibble</span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># deixando a tibble desaninhada</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># aplicando o parser da lista de jogos</span></span>
<span><span class="fu">parser_lista_jogos</span><span class="op">(</span>target_path <span class="op">=</span> <span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html">dir_ls</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">path_para_jogos</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html">paged_table</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id_jogo"],"name":[1],"type":["int"],"align":["right"]},{"label":["nm_jogo"],"name":[2],"type":["chr"],"align":["left"]},{"label":["nm_original"],"name":[3],"type":["chr"],"align":["left"]},{"label":["thumb"],"name":[4],"type":["chr"],"align":["left"]},{"label":["link"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"13494","2":"Brass: Birmingham","3":"Brass: Birmingham","4":"https://storage.googleapis.com/ludopedia-capas/13494_t.jpg","5":"jogo/brass-birmingham"},{"1":"43761","2":"Old Dragon 2ª Edição: Livro I - Regras Básicas","3":"Old Dragon 2ª Edição: Livro I - Regras Básicas","4":"https://storage.googleapis.com/ludopedia-capas/43761_t.jpg","5":"jogo/old-dragon-2-edicao-livro-i-regras-basicas"},{"1":"8176","2":"Dungeons & Dragons (5ª Edição): Livro do Jogador","3":"Dungeons & Dragons (5th Edition) - Player's Handbook","4":"https://storage.googleapis.com/ludopedia-capas/8176_t.jpg","5":"jogo/dungeons-dragons-5th-edition-player-s-handbook"},{"1":"13749","2":"Projeto Gaia","3":"Gaia Project","4":"https://storage.googleapis.com/ludopedia-capas/13749_t.jpg","5":"jogo/gaia-project"},{"1":"8858","2":"Terraforming Mars","3":"Terraforming Mars","4":"https://storage.googleapis.com/ludopedia-capas/8858_t.jpg","5":"jogo/terraforming-mars"},{"1":"21102","2":"Vampiro: A Máscara","3":"Vampire: The Masquerade (2nd Edition)","4":"https://storage.googleapis.com/ludopedia-capas/21102_t.jpg","5":"jogo/vampire-the-masquerade-2nd-edition"},{"1":"19085","2":"Chamado de Cthulhu (7ª Edição) - Livro do Guardião","3":"Call of Cthulhu (7th Edition) - Keeper Rulebook","4":"https://storage.googleapis.com/ludopedia-capas/19085_t.jpg","5":"jogo/call-of-cthulhu-7th-edition-keeper-rulebook"},{"1":"8624","2":"Gloomhaven","3":"Gloomhaven","4":"https://storage.googleapis.com/ludopedia-capas/8624_t.jpg","5":"jogo/gloomhaven"},{"1":"14902","2":"Dungeons & Dragons 3.5a. Edição: Livro do Jogador","3":"Player's Handbook (D&D 3.5e)","4":"https://storage.googleapis.com/ludopedia-capas/14902_t.jpg","5":"jogo/player-s-handbook-d-d-3-5e"},{"1":"404","2":"Terra Mystica","3":"Terra Mystica","4":"https://storage.googleapis.com/ludopedia-capas/404_t.jpg","5":"jogo/terra-mystica"},{"1":"13196","2":"Brass: Lancashire","3":"Brass: Lancashire","4":"https://storage.googleapis.com/ludopedia-capas/13196_t.jpg","5":"jogo/brass-lancashire"},{"1":"12731","2":"Dungeons & Dragons (5ª Edição): Kit Introdutório","3":"Dungeons & Dragons (5th Edition) - Starter Set","4":"https://storage.googleapis.com/ludopedia-capas/12731_t.jpg","5":"jogo/dungeons-dragons-5th-edition-starter-set"},{"1":"1127","2":"Dungeons & Dragons","3":"The New Easy to Master Dungeons & Dragons","4":"https://storage.googleapis.com/ludopedia-capas/1127_t.jpg","5":"jogo/the-new-easy-to-master-dungeons-dragons"},{"1":"25048","2":"Gloomhaven: Presas do Leão","3":"Gloomhaven: Jaws of the Lion","4":"https://storage.googleapis.com/ludopedia-capas/25048_t.jpg","5":"jogo/gloomhaven-jaws-of-the-lion"},{"1":"12713","2":"Captive","3":"Graphic Novel Adventures: Captive","4":"https://storage.googleapis.com/ludopedia-capas/12713_t.jpg","5":"jogo/graphic-novel-adventures-captive"},{"1":"14910","2":"Twilight Imperium (4ª Edição)","3":"Twilight Imperium: Fourth Edition","4":"https://storage.googleapis.com/ludopedia-capas/14910_t.jpg","5":"jogo/twilight-imperium-fourth-edition"},{"1":"60652","2":"3DX","3":"3DX","4":"https://storage.googleapis.com/ludopedia-capas/60652_t.jpg","5":"jogo/3dx"},{"1":"17559","2":"Mage Knight: Edição Definitiva","3":"Mage Knight: Ultimate Edition","4":"https://storage.googleapis.com/ludopedia-capas/17559_t.jpg","5":"jogo/mage-knight-ultimate-edition"},{"1":"29783","2":"Great Western Trail: Segunda Edição","3":"Great Western Trail (Second Edition)","4":"https://storage.googleapis.com/ludopedia-capas/29783_t.jpg","5":"jogo/great-western-trail-second-edition"},{"1":"23555","2":"Lobisomem: O Apocalipse","3":"Werewolf: The Apocalypse (2nd Edition)","4":"https://storage.googleapis.com/ludopedia-capas/23555_t.jpg","5":"jogo/werewolf-the-apocalypse-2nd-edition"},{"1":"8285","2":"7 Wonders Duel","3":"7 Wonders Duel","4":"https://storage.googleapis.com/ludopedia-capas/8285_t.jpg","5":"jogo/7-wonders-duel"},{"1":"26076","2":"A Herança de Cthulhu","3":"A Herança de Cthulhu","4":"https://storage.googleapis.com/ludopedia-capas/26076_t.jpg","5":"jogo/a-heranca-de-cthulhu"},{"1":"13411","2":"GURPS - Módulo Básico (Segunda Edição)","3":"GURPS Basic Set (Second Edition)","4":"https://storage.googleapis.com/ludopedia-capas/13411_t.jpg","5":"jogo/gurps-basic-set-second-edition"},{"1":"9330","2":"Star Wars: Rebellion","3":"Star Wars: Rebellion","4":"https://storage.googleapis.com/ludopedia-capas/9330_t.jpg","5":"jogo/star-wars-rebellion"},{"1":"14901","2":"Dungeons & Dragons 3a. Edição: Livro do Jogador","3":"Player's Handbook (D&D 3e)","4":"https://storage.googleapis.com/ludopedia-capas/14901_t.jpg","5":"jogo/player-s-handbook-d-d-3e"},{"1":"20829","2":"O Senhor dos Anéis: Jornadas na Terra Média","3":"The Lord of the Rings: Journeys in Middle-Earth","4":"https://storage.googleapis.com/ludopedia-capas/20829_t.jpg","5":"jogo/the-lord-of-the-rings-journeys-in-middle-earth"},{"1":"187","2":"The Castles of Burgundy","3":"The Castles of Burgundy","4":"https://storage.googleapis.com/ludopedia-capas/187_t.jpg","5":"jogo/the-castles-of-burgundy"},{"1":"20275","2":"Vampiro: A Máscara (5ª Edição)","3":"Vampire: The Masquerade (5th Edition) - Core Book","4":"https://storage.googleapis.com/ludopedia-capas/20275_t.jpg","5":"jogo/vampire-the-masquerade-5th-edition-core-book"},{"1":"10168","2":"Great Western Trail","3":"Great Western Trail","4":"https://storage.googleapis.com/ludopedia-capas/10168_t.jpg","5":"jogo/great-western-trail"},{"1":"21129","2":"Mago: A Ascensão","3":"Mage: The Ascension (2nd Edition)","4":"https://storage.googleapis.com/ludopedia-capas/21129_t.jpg","5":"jogo/mage-the-ascension-2nd-edition"},{"1":"27900","2":"Hitodama - A Jornada das almas","3":"Hitodama - A Jornada das almas","4":"https://storage.googleapis.com/ludopedia-capas/27900_t.jpg","5":"jogo/hitodama-a-jornada-das-almas"},{"1":"48","2":"Puerto Rico","3":"Puerto Rico","4":"https://storage.googleapis.com/ludopedia-capas/48_t.jpg","5":"jogo/puerto-rico"},{"1":"32437","2":"Aventuras na Era Hiboriana RPG","3":"Aventuras na Era Hiboriana RPG","4":"https://storage.googleapis.com/ludopedia-capas/32437_t.jpg","5":"jogo/aventuras-na-era-hiboriana-rpg"},{"1":"13588","2":"Clãs da Caledônia","3":"Clans of Caledonia","4":"https://storage.googleapis.com/ludopedia-capas/13588_t.jpg","5":"jogo/clans-of-caledonia"},{"1":"25941","2":"Duna: Imperium","3":"Dune: Imperium","4":"https://storage.googleapis.com/ludopedia-capas/25941_t.jpg","5":"jogo/dune-imperium"},{"1":"21138","2":"Vampire: The Dark Ages","3":"Vampire: The Dark Ages","4":"https://storage.googleapis.com/ludopedia-capas/21138_t.jpg","5":"jogo/vampire-the-dark-ages"},{"1":"7863","2":"GURPS - Módulo Básico (Primeira Edição)","3":"GURPS Basic Set (First Edition)","4":"https://storage.googleapis.com/ludopedia-capas/7863_t.jpg","5":"jogo/gurps-basic-set-first-edition"},{"1":"20418","2":"Wingspan","3":"Wingspan","4":"https://storage.googleapis.com/ludopedia-capas/20418_t.jpg","5":"jogo/wingspan"},{"1":"9426","2":"Dungeon World Roleplaying Game","3":"Dungeon World Roleplaying Game","4":"https://storage.googleapis.com/ludopedia-capas/9426_t.jpg","5":"jogo/dungeon-world-roleplaying-game"},{"1":"11478","2":"Lisboa","3":"Lisboa","4":"https://storage.googleapis.com/ludopedia-capas/11478_t.jpg","5":"jogo/lisboa"},{"1":"16912","2":"Lobisomem","3":"Graphic Novel Adventures: Loup Garou","4":"https://storage.googleapis.com/ludopedia-capas/16912_t.jpg","5":"jogo/graphic-novel-adventures-loup-garou"},{"1":"503","2":"Twilight Struggle","3":"Twilight Struggle","4":"https://storage.googleapis.com/ludopedia-capas/503_t.jpg","5":"jogo/twilight-struggle"},{"1":"21610","2":"Tales from the Loop","3":"Tales from the Loop","4":"https://storage.googleapis.com/ludopedia-capas/21610_t.jpg","5":"jogo/tales-from-the-loop"},{"1":"11425","2":"Um Banquete a Odin","3":"A Feast for Odin","4":"https://storage.googleapis.com/ludopedia-capas/11425_t.jpg","5":"jogo/a-feast-for-odin"},{"1":"22504","2":"Pathfinder 2ª Edição - Livro Básico","3":"Pathfinder Core Rulebook (2nd Edition)","4":"https://storage.googleapis.com/ludopedia-capas/22504_t.jpg","5":"jogo/pathfinder-core-rulebook-2nd-edition"},{"1":"10959","2":"Spirit Island","3":"Spirit Island","4":"https://storage.googleapis.com/ludopedia-capas/10959_t.jpg","5":"jogo/spirit-island"},{"1":"2614","2":"First Quest - Advanced Dungeons & Dragons 2ª Edition","3":"AD&D (2nd Edition) - First Quest","4":"https://storage.googleapis.com/ludopedia-capas/2614_t.jpg","5":"jogo/ad-d-2nd-edition-first-quest"},{"1":"15950","2":"Root","3":"Root","4":"https://storage.googleapis.com/ludopedia-capas/15950_t.jpg","5":"jogo/root"},{"1":"6764","2":"Scythe","3":"Scythe","4":"https://storage.googleapis.com/ludopedia-capas/6764_t.jpg","5":"jogo/scythe"},{"1":"8149","2":"Star Wars: Fronteira do Império - Livro Básico","3":"Star Wars: Edge of the Empire Core Rulebook","4":"https://storage.googleapis.com/ludopedia-capas/8149_t.jpg","5":"jogo/star-wars-edge-of-the-empire-core-rulebook"},{"1":"433","2":"Guerra do Anel (Segunda Edição)","3":"War of the Ring (second edition)","4":"https://storage.googleapis.com/ludopedia-capas/433_t.jpg","5":"jogo/war-of-the-ring-second-edition"},{"1":"12600","2":"Pathfinder RPG: Livro Básico","3":"Pathfinder Roleplaying Game Core Rulebook (1st Ed)","4":"https://storage.googleapis.com/ludopedia-capas/12600_t.jpg","5":"jogo/pathfinder-roleplaying-game-core-rulebook-1st-ed"},{"1":"1500","2":"Old Dragon: Módulo Básico","3":"Old Dragon: Módulo Básico","4":"https://storage.googleapis.com/ludopedia-capas/1500_t.jpg","5":"jogo/old-dragon-modulo-basico"},{"1":"23515","2":"Zombicide: Segunda Edição","3":"Zombicide: Second Edition","4":"https://storage.googleapis.com/ludopedia-capas/23515_t.jpg","5":"jogo/zombicide-second-edition"},{"1":"11112","2":"Mansions of Madness (2ª Edição)","3":"Mansions of Madness: Second Edition","4":"https://storage.googleapis.com/ludopedia-capas/11112_t.jpg","5":"jogo/mansions-of-madness-second-edition"},{"1":"11110","2":"Tormenta RPG - Edição Revisada","3":"Tormenta RPG - Edição Revisada","4":"https://storage.googleapis.com/ludopedia-capas/11110_t.jpg","5":"jogo/tormenta-rpg-edicao-revisada"},{"1":"24301","2":"Clash of Cultures: Monumental Edition","3":"Clash of Cultures: Monumental Edition","4":"https://storage.googleapis.com/ludopedia-capas/24301_t.jpg","5":"jogo/clash-of-cultures-monumental-edition"},{"1":"35597","2":"Nessus - Jogo Rápido","3":"Nessus - Jogo Rápido","4":"https://storage.googleapis.com/ludopedia-capas/35597_t.jpg","5":"jogo/nessus-jogo-rapido"},{"1":"5058","2":"Five Tribes","3":"Five Tribes","4":"https://storage.googleapis.com/ludopedia-capas/5058_t.jpg","5":"jogo/five-tribes"},{"1":"24635","2":"Vampiro - Sozinho na Escuridão","3":"Vampiro - Sozinho na Escuridão","4":"https://storage.googleapis.com/ludopedia-capas/24635_t.jpg","5":"jogo/vampiro-sozinho-na-escuridao"},{"1":"54680","2":"Oeste Sombrio","3":"Oeste Sombrio","4":"https://storage.googleapis.com/ludopedia-capas/54680_t.jpg","5":"jogo/oeste-sombrio"},{"1":"8627","2":"Through The Ages: Uma Nova História da Civilização","3":"Through the Ages: A New Story of Civilization","4":"https://storage.googleapis.com/ludopedia-capas/8627_t.jpg","5":"jogo/through-the-ages-a-new-story-of-civilization"},{"1":"14836","2":"Lenda dos Cinco Anéis 4ª Edição RPG","3":"Legend of the Five Rings 4th Edition RPG","4":"https://storage.googleapis.com/ludopedia-capas/14836_t.jpg","5":"jogo/legend-of-the-five-rings-4th-edition-rpg"},{"1":"15490","2":"Nemesis","3":"Nemesis","4":"https://storage.googleapis.com/ludopedia-capas/15490_t.jpg","5":"jogo/nemesis"},{"1":"33119","2":"Hegemony: Conduza Sua Classe À Vitória","3":"Hegemony: Lead Your Class to Victory","4":"https://storage.googleapis.com/ludopedia-capas/33119_t.jpg","5":"jogo/hegemony-lead-your-class-to-victory"},{"1":"23742","2":"Notequest","3":"Notequest","4":"https://storage.googleapis.com/ludopedia-capas/23742_t.jpg","5":"jogo/notequest"},{"1":"11178","2":"Clank!: Uma Aventura de Construção de Baralho","3":"Clank!: A Deck-Building Adventure","4":"https://storage.googleapis.com/ludopedia-capas/11178_t.jpg","5":"jogo/clank-a-deck-building-adventure"},{"1":"14816","2":"Numenera","3":"Numenera","4":"https://storage.googleapis.com/ludopedia-capas/14816_t.jpg","5":"jogo/numenera"},{"1":"25979","2":"7 Wonders: Segunda Edição","3":"7 Wonders (Second Edition)","4":"https://storage.googleapis.com/ludopedia-capas/25979_t.jpg","5":"jogo/7-wonders-second-edition"},{"1":"14605","2":"O Mundo das Trevas","3":"World of Darkness","4":"https://storage.googleapis.com/ludopedia-capas/14605_t.jpg","5":"jogo/world-of-darkness"},{"1":"16910","2":"A Cidade de Your Town","3":"Graphic Novel Adventures: Your Town","4":"https://storage.googleapis.com/ludopedia-capas/16910_t.jpg","5":"jogo/graphic-novel-adventures-your-town"},{"1":"14981","2":"Azul","3":"Azul","4":"https://storage.googleapis.com/ludopedia-capas/14981_t.jpg","5":"jogo/azul"},{"1":"15097","2":"Livro do Jogador (AD&D 2e Revisado)","3":"Player's Handbook (AD&D 2e Revised)","4":"https://storage.googleapis.com/ludopedia-capas/15097_t.jpg","5":"jogo/player-s-handbook-ad-d-2e-revised"},{"1":"170","2":"Mage Knight Board Game","3":"Mage Knight Board Game","4":"https://storage.googleapis.com/ludopedia-capas/170_t.jpg","5":"jogo/mage-knight-board-game"},{"1":"25895","2":"As Ruínas Perdidas de Arnak","3":"Lost Ruins of Arnak","4":"https://storage.googleapis.com/ludopedia-capas/25895_t.jpg","5":"jogo/lost-ruins-of-arnak"},{"1":"26472","2":"Tormenta20: Livro Básico Edição de Luxo","3":"Tormenta20 — Livro Básico Edição de Luxo","4":"https://storage.googleapis.com/ludopedia-capas/26472_t.jpg","5":"jogo/tormenta20-livro-basico-edicao-de-luxo"},{"1":"1860","2":"Caverna: The Cave Farmers","3":"Caverna: The Cave Farmers","4":"https://storage.googleapis.com/ludopedia-capas/1860_t.jpg","5":"jogo/caverna-the-cave-farmers"},{"1":"10405","2":"Four Against Darkness - Edição Brasileira","3":"Four Against Darkness","4":"https://storage.googleapis.com/ludopedia-capas/10405_t.jpg","5":"jogo/four-against-darkness"},{"1":"16788","2":"Everdell","3":"Everdell","4":"https://storage.googleapis.com/ludopedia-capas/16788_t.jpg","5":"jogo/everdell"},{"1":"22056","2":"Tormenta 20: Livro Básico","3":"Tormenta 20: Livro Básico","4":"https://storage.googleapis.com/ludopedia-capas/22056_t.jpg","5":"jogo/tormenta-20-livro-basico"},{"1":"17609","2":"Castelo Falkenstein: Livro de Regras","3":"Castle Falkenstein","4":"https://storage.googleapis.com/ludopedia-capas/17609_t.jpg","5":"jogo/castle-falkenstein"},{"1":"7231","2":"Pandemic Legacy: 1ª Temporada","3":"Pandemic Legacy: Season 1","4":"https://storage.googleapis.com/ludopedia-capas/7231_t.jpg","5":"jogo/pandemic-legacy-season-1"},{"1":"18993","2":"Barrage","3":"Barrage","4":"https://storage.googleapis.com/ludopedia-capas/18993_t.jpg","5":"jogo/barrage"},{"1":"14947","2":"O Um Anel: Aventuras Além do Limiar do Ermo","3":"The One Ring: Adventures over the Edge of the Wild","4":"https://storage.googleapis.com/ludopedia-capas/14947_t.jpg","5":"jogo/the-one-ring-adventures-over-the-edge-of-the-wild"},{"1":"17554","2":"Old Dragon Aprimorado","3":"Old Dragon Aprimorado","4":"https://storage.googleapis.com/ludopedia-capas/17554_t.jpg","5":"jogo/old-dragon-aprimorado"},{"1":"20444","2":"Tainted Grail: A Queda de Avalon","3":"Tainted Grail: The Fall of Avalon","4":"https://storage.googleapis.com/ludopedia-capas/20444_t.jpg","5":"jogo/tainted-grail-the-fall-of-avalon"},{"1":"2194","2":"Concordia","3":"Concordia","4":"https://storage.googleapis.com/ludopedia-capas/2194_t.jpg","5":"jogo/concordia"},{"1":"14517","2":"FF 01 — O Feiticeiro da Montanha de Fogo","3":"The Warlock of Firetop Mountain (I)","4":"https://storage.googleapis.com/ludopedia-capas/14517_t.jpg","5":"jogo/the-warlock-of-firetop-mountain-i"},{"1":"9538","2":"Anachrony","3":"Anachrony","4":"https://storage.googleapis.com/ludopedia-capas/9538_t.jpg","5":"jogo/anachrony"},{"1":"15752","2":"Hora de Aventura: Roleplaying Game","3":"Hora de Aventuras: Juego de Rol RPG","4":"https://storage.googleapis.com/ludopedia-capas/15752_t.jpg","5":"jogo/hora-de-aventuras-juego-de-rol-rpg"},{"1":"32088","2":"Arkham Horror: The Card Game (Revised Edition)","3":"Arkham Horror: The Card Game (Revised Edition)","4":"https://storage.googleapis.com/ludopedia-capas/32088_t.jpg","5":"jogo/arkham-horror-the-card-game-revised-edition"},{"1":"14601","2":"Savage Worlds: Livro de Regras","3":"Savage Worlds Deluxe","4":"https://storage.googleapis.com/ludopedia-capas/14601_t.jpg","5":"jogo/savage-worlds-deluxe"},{"1":"32507","2":"Ark Nova","3":"Ark Nova","4":"https://storage.googleapis.com/ludopedia-capas/32507_t.jpg","5":"jogo/ark-nova"},{"1":"32443","2":"Licantropo - Maldição de Sangue","3":"Licantropo - Maldição de Sangue","4":"https://storage.googleapis.com/ludopedia-capas/32443_t.jpg","5":"jogo/licantropo-maldicao-de-sangue"},{"1":"14346","2":"Brazil: Imperial","3":"Brazil: Imperial","4":"https://storage.googleapis.com/ludopedia-capas/14346_t.jpg","5":"jogo/brazil-imperial"},{"1":"22078","2":"Ronin","3":"Ronin","4":"https://storage.googleapis.com/ludopedia-capas/22078_t.jpg","5":"jogo/ronin"},{"1":"13774","2":"Dungeon Crawl Classics Role Playing Game - DCC RPG","3":"Dungeon Crawl Classics Role Playing Game - DCC RPG","4":"https://storage.googleapis.com/ludopedia-capas/13774_t.jpg","5":"jogo/dungeon-crawl-classics-role-playing-game-dcc-rpg"},{"1":"16085","2":"Teotihuacan: City of Gods","3":"Teotihuacan: City of Gods","4":"https://storage.googleapis.com/ludopedia-capas/16085_t.jpg","5":"jogo/teotihuacan-city-of-gods"},{"1":"32444","2":"Bruxo - Pacto das Sombras","3":"Bruxo - Pacto das Sombras","4":"https://storage.googleapis.com/ludopedia-capas/32444_t.jpg","5":"jogo/bruxo-pacto-das-sombras"},{"1":"134","2":"Trajan","3":"Trajan","4":"https://storage.googleapis.com/ludopedia-capas/134_t.jpg","5":"jogo/trajan"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Com base nessa informação, já temos acesso a lista de alguns jogos cadastrados no portal da Ludopedia, No entanto, ainda há o segundo elemento daquela lista que acabamos de parsear, <code>total</code>, que nos informa sobre a quantidade total de jogos cadastrados. Para pegar esta informação, basta mudarmos o <em>string</em> que passamos para a função <code>pluck</code>, conforme apresentado abaixo.</p>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># função para pegar a quantidade total de jogos disponiveis</span></span>
<span><span class="va">pegar_total_jogos</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">access_token</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># faz um GET da pagina default dos jogos, parseia o conteudo e pega so o elemento</span></span>
<span>  <span class="co"># da lista que contem a quantidade total de jogos cadastrados na base da Ludopedia</span></span>
<span>  <span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/GET.html">GET</a></span><span class="op">(</span><span class="st">'https://ludopedia.com.br/api/v1/jogos'</span>, </span>
<span>            <span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/add_headers.html">add_headers</a></span><span class="op">(</span>AUTHORIZATION <span class="op">=</span> <span class="va">access_token</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/content.html">content</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html">pluck</a></span><span class="op">(</span><span class="st">'total'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># pegando o total de jogos cadastrados na ludopedia</span></span>
<span><span class="va">total_de_jogos</span> <span class="op">&lt;-</span> <span class="fu">pegar_total_jogos</span><span class="op">(</span>access_token <span class="op">=</span> <span class="va">meu_token</span><span class="op">)</span></span>
<span><span class="va">total_de_jogos</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 58640</code></pre>
</div>
</div>
<p>Como podemos notar, existem 58.640 cadastrados no portal da Ludopedia. Como temos acesso à 100 jogos por página da requisição, isto nos diz que precisaremos percorrer 58.640 / 100 = 586.4 = 587 páginas para obter a lista de <strong>todos</strong> os jogos disponíveis (<em>i.e.</em>, total de jogos dividido por 100, arredondando o resultado para cima). Assim, bastaria iterar os valores do argumento <code>pagina</code> da função <code>pegar_lista_jogos</code> do índice 1 até o número de páginas definido acima dentro de um <code><a href="https://purrr.tidyverse.org/reference/map.html">purrr::map</a></code>, por exemplo.</p>
<p>Usamos o <em>endpoint</em> da lista de jogos cadastrados para obter os nomes dos jogos e o seu identificador numérico único, o que é ótimo se não tivermos noção do nome dos jogos nem nada do gênero. Por outro lado, se tivermos um jogo específico em mente e quisermos obter apenas o seu identificador numérico, podemos passar o seu nome como um argumento para a <code>query</code> do mesmo <em>endpoint</em> (<code>search = &lt;nome do jogo&gt;</code>). Eu empacotei essa aplicação do <em>endpoint</em> em outra função, e usei como exemplo a busca pelo identificador do jogo <code>Ticket to Ride</code> (que usamos como exemplo lá no post sobre a API XML do BoardGameGeek). O resultado que obtivemos (já parseado) revela que este uso do <em>endpoint</em> traz todos os jogos que, de alguma forma, tenham haver com aquele que buscamos - no nosso caso, também tivemos acesso à todas as expansões e implementações do jogo base.</p>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># função para pegar a lista de jogos que contenham uma string especifica no nome</span></span>
<span><span class="va">pegar_id_jogo</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">nome_do_jogo</span>, <span class="va">access_token</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># pegando os jogos da pagina selecionada</span></span>
<span>  <span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/GET.html">GET</a></span><span class="op">(</span><span class="st">'https://ludopedia.com.br/api/v1/jogos'</span>, </span>
<span>            <span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/add_headers.html">add_headers</a></span><span class="op">(</span>AUTHORIZATION <span class="op">=</span> <span class="va">access_token</span><span class="op">)</span>,</span>
<span>            query <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>search <span class="op">=</span> <span class="va">nome_do_jogo</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># pegando o exemplo do ticket to ride, como no scrapper do boardgamegekk</span></span>
<span><span class="fu">pegar_id_jogo</span><span class="op">(</span>nome_do_jogo <span class="op">=</span> <span class="st">'Ticket to Ride'</span>, access_token <span class="op">=</span> <span class="va">meu_token</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># pegando o content da resposta</span></span>
<span>  <span class="fu"><a href="https://httr.r-lib.org/reference/content.html">content</a></span><span class="op">(</span>simplifyDataFrame <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># extraindo o elemento jogos de dentro da lista</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html">pluck</a></span><span class="op">(</span><span class="st">'jogos'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># criando a tabela para a visualização na página</span></span>
<span>  <span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html">paged_table</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["id_jogo"],"name":[1],"type":["int"],"align":["right"]},{"label":["nm_jogo"],"name":[2],"type":["chr"],"align":["left"]},{"label":["nm_original"],"name":[3],"type":["chr"],"align":["left"]},{"label":["thumb"],"name":[4],"type":["chr"],"align":["left"]},{"label":["link"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"2","2":"Ticket to Ride","3":"Ticket to Ride","4":"https://storage.googleapis.com/ludopedia-capas/2_t.jpg","5":"jogo/ticket-to-ride","_rn_":"1"},{"1":"133","2":"Ticket to Ride: Europa","3":"Ticket to Ride: Europe","4":"https://storage.googleapis.com/ludopedia-capas/133_t.jpg","5":"jogo/ticket-to-ride-europe","_rn_":"2"},{"1":"29022","2":"Ticket to Ride: Europa - 15 Anos","3":"Ticket to Ride: Europe – 15th Anniversary","4":"https://storage.googleapis.com/ludopedia-capas/29022_t.jpg","5":"jogo/ticket-to-ride-europe-15th-anniversary","_rn_":"3"},{"1":"4176","2":"Ticket to Ride: 10th Anniversary","3":"Ticket to Ride: 10th Anniversary","4":"https://storage.googleapis.com/ludopedia-capas/4176_t.jpg","5":"jogo/ticket-to-ride-10th-anniversary","_rn_":"4"},{"1":"10799","2":"Ticket to Ride: Trilhos e Velas","3":"Ticket to Ride: Rails & Sails","4":"https://storage.googleapis.com/ludopedia-capas/10799_t.jpg","5":"jogo/ticket-to-ride-rails-sails","_rn_":"5"},{"1":"958","2":"Ticket to Ride: Países Nórdicos","3":"Ticket to Ride: Nordic Countries","4":"https://storage.googleapis.com/ludopedia-capas/958_t.jpg","5":"jogo/ticket-to-ride-nordic-countries","_rn_":"6"},{"1":"53416","2":"Ticket to Ride Legacy: Lendas do Oeste","3":"Ticket to Ride Legacy: Legends of the West","4":"https://storage.googleapis.com/ludopedia-capas/53416_t.jpg","5":"jogo/ticket-to-ride-legacy-legends-of-the-west","_rn_":"7"},{"1":"18431","2":"Ticket to Ride: New York","3":"Ticket to Ride: New York","4":"https://storage.googleapis.com/ludopedia-capas/18431_t.jpg","5":"jogo/ticket-to-ride-new-york","_rn_":"8"},{"1":"21961","2":"Ticket to Ride: Londres","3":"Ticket to Ride: London","4":"https://storage.googleapis.com/ludopedia-capas/21961_t.jpg","5":"jogo/ticket-to-ride-london","_rn_":"9"},{"1":"14933","2":"Ticket to Ride: Alemanha","3":"Ticket to Ride: Germany","4":"https://storage.googleapis.com/ludopedia-capas/14933_t.jpg","5":"jogo/ticket-to-ride-germany","_rn_":"10"},{"1":"957","2":"Ticket to Ride: Märklin","3":"Ticket to Ride: Märklin","4":"https://storage.googleapis.com/ludopedia-capas/957_t.jpg","5":"jogo/ticket-to-ride-marklin","_rn_":"11"},{"1":"12719","2":"Ticket to Ride: Primeira Viagem","3":"Ticket to Ride: First Journey (Europe)","4":"https://storage.googleapis.com/ludopedia-capas/12719_t.jpg","5":"jogo/ticket-to-ride-first-journey-europe","_rn_":"12"},{"1":"35958","2":"Ticket to Ride: San Francisco","3":"Ticket to Ride: San Francisco","4":"https://storage.googleapis.com/ludopedia-capas/35958_t.jpg","5":"jogo/ticket-to-ride-san-francisco","_rn_":"13"},{"1":"24692","2":"Ticket to Ride: Amsterdam","3":"Ticket to Ride: Amsterdam","4":"https://storage.googleapis.com/ludopedia-capas/24692_t.jpg","5":"jogo/ticket-to-ride-amsterdam","_rn_":"14"},{"1":"11170","2":"Ticket to Ride: First Journey (U.S.)","3":"Ticket to Ride: First Journey (U.S.)","4":"https://storage.googleapis.com/ludopedia-capas/11170_t.jpg","5":"jogo/ticket-to-ride-first-journey-u-s","_rn_":"15"},{"1":"960","2":"Ticket to Ride: The Card Game","3":"Ticket to Ride: The Card Game","4":"https://storage.googleapis.com/ludopedia-capas/960_t.jpg","5":"jogo/ticket-to-ride-the-card-game","_rn_":"16"},{"1":"37415","2":"Ticket to Ride: Trem Fantasma","3":"Ticket To Ride: Ghost Train","4":"https://storage.googleapis.com/ludopedia-capas/37415_t.jpg","5":"jogo/ticket-to-ride-ghost-train","_rn_":"17"},{"1":"18311","2":"Ticket To Ride Demo","3":"Ticket To Ride Demo","4":"https://storage.googleapis.com/ludopedia-capas/18311_t.jpg","5":"jogo/ticket-to-ride-demo","_rn_":"18"},{"1":"52446","2":"Ticket to Ride: Berlin","3":"Ticket to Ride: Berlin","4":"https://storage.googleapis.com/ludopedia-capas/52446_t.jpg","5":"jogo/ticket-to-ride-berlin","_rn_":"19"},{"1":"41028","2":"Ticket to Ride: Northern Lights","3":"Ticket to Ride: Northern Lights","4":"https://storage.googleapis.com/ludopedia-capas/41028_t.jpg","5":"jogo/ticket-to-ride-northern-lights","_rn_":"20"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Acredito que estas são as funcionalidades básicas mais importantes deste <em>endpoint</em>. Vamos passar ao próximo!</p>
</section><section id="pegando-as-informações-de-um-jogo" class="level2"><h2 class="anchored" data-anchor-id="pegando-as-informações-de-um-jogo">Pegando as informações de um jogo</h2>
<p>O outro <em>endpoint</em> que exploraremos é aquele que traz os metadados dos jogos de tabuleiro, e que faz uso do identificador numérico do jogo diretamente na <code>url</code> da requisição. Desta forma, as informações da lista de jogos cadastrados no portal da Ludopedia passa a ser muito importante para utilizarmos este <em>endpoint</em>. Tendo isto em mente, vamos preparar a função <code>pegar_infos_jogo</code> adicionando um argumento que receberá o identificador do jogo (<code>id_jogo</code>) que buscaremos - novamente, utilizando o <code>header</code> com o token de acesso e salvando o arquivo JSON de resposta em disco para usarmos depois. Como exemplo, vamos usar essa função para pegar os metadados do <code>Ticket do Ride</code>.</p>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># função para pegar as informações de um jogo</span></span>
<span><span class="va">pegar_infos_jogo</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id_jogo</span>, <span class="va">access_token</span>, <span class="va">path_salvar</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># pegando os detalhes do jogo</span></span>
<span>  <span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/GET.html">GET</a></span><span class="op">(</span>url <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">'https://ludopedia.com.br/api/v1/jogos/{id_jogo}'</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://httr.r-lib.org/reference/add_headers.html">add_headers</a></span><span class="op">(</span>AUTHORIZATION <span class="op">=</span> <span class="va">access_token</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://httr.r-lib.org/reference/write_disk.html">write_disk</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="va">path_salvar</span>, <span class="st">'/info_do_jogo_{id_jogo}.json'</span><span class="op">)</span>,</span>
<span>                       overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># pegando as informações do Ticket to Ride</span></span>
<span><span class="va">metadados</span> <span class="op">&lt;-</span> <span class="fu">pegar_infos_jogo</span><span class="op">(</span></span>
<span>  id_jogo <span class="op">=</span> <span class="fl">2</span>, </span>
<span>  access_token <span class="op">=</span> <span class="va">meu_token</span>, </span>
<span>  path_salvar <span class="op">=</span> <span class="va">path_para_metadata</span></span>
<span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Vamos dar uma olhada na estrutura do arquivo JSON que recebemos como resposta, de forma a saber o que teremos que parsear.</p>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/read_json.html">read_json</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html">dir_ls</a></span><span class="op">(</span><span class="va">path_para_metadata</span><span class="op">)</span>, simplifyDataFrame <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="va">glimpse</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>List of 21
 $ id_jogo         : int 2
 $ nm_jogo         : chr "Ticket to Ride"
 $ thumb           : chr "https://storage.googleapis.com/ludopedia-capas/2_t.jpg"
 $ tp_jogo         : chr "b"
 $ link            : chr "https://ludopedia.com.br/jogo/ticket-to-ride"
 $ ano_publicacao  : int 2004
 $ ano_nacional    : int 2014
 $ qt_jogadores_min: int 2
 $ qt_jogadores_max: int 5
 $ mecanicas       :'data.frame':   2 obs. of  2 variables:
  ..$ id_mecanica: int [1:2] 3 18
  ..$ nm_mecanica: chr [1:2] "Gerenciamento de Mãos" "Construção de Redes e Rotas"
 $ categorias      :'data.frame':   1 obs. of  2 variables:
  ..$ id_categoria: int 111
  ..$ nm_categoria: chr "Jogo de Entrada"
 $ temas           :'data.frame':   1 obs. of  2 variables:
  ..$ id_tema: int 27
  ..$ nm_tema: chr "Transportes"
 $ artistas        :'data.frame':   2 obs. of  2 variables:
  ..$ id_profissional: int [1:2] 6 5
  ..$ nm_profissional: chr [1:2] "Julien Delval" "Cyrille Daujean"
 $ designers       :'data.frame':   1 obs. of  2 variables:
  ..$ id_profissional: int 4
  ..$ nm_profissional: chr "Alan R. Moon"
 $ vl_tempo_jogo   : int 45
 $ idade_minima    : int 8
 $ qt_tem          : int 4160
 $ qt_teve         : int 494
 $ qt_favorito     : int 545
 $ qt_quer         : int 2207
 $ qt_jogou        : int 5280</code></pre>
</div>
</div>
<p>Como podemos ver, existem duas principais estruturas de dados no arquivo. Em uma destas estruturas estão as informações armazenadas em vetores com um único elemento, como o ano de publicação do jogo, informações sobre quantidade de jogadores e título do jogo. A outra estrutura existente no arquivo são algumas informações armazenadas como <code>data.frame</code>, como as informações da mecânica de jogo, os temas e nome dos criadores do jogo. Estas informações estão nesta estrutura pois elas tendem a ser naturalmente multidimensionais, e possivelmente é mais fácil armazená-las em uma estrutura na qual você consiga discriminar o metadado linha a linha. Dada a natureza destas duas estruturas de dados, podemos parsear a primeira delas de forma bem simples, usando a função <code><a href="https://purrr.tidyverse.org/reference/keep.html">purrr::discard</a></code> para descartar todos os elementos do arquivo JSON que sejam um <code>data.frame</code> (<em>i.e.</em>, empregando o teste lógico <code>is.data.frame</code>), e juntando todos os elementos restantes coluna à coluna (<em>i.e.</em>, usando um <code>bind_cols</code>).</p>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/read_json.html">read_json</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html">dir_ls</a></span><span class="op">(</span><span class="va">path_para_metadata</span><span class="op">)</span>, simplifyDataFrame <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># descartando todos os elementos que sao listas</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html">discard</a></span><span class="op">(</span><span class="va">is.data.frame</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># juntando cada elemento da lista coluna a coluna</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># visualizando a tabela</span></span>
<span>  <span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html">paged_table</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id_jogo"],"name":[1],"type":["int"],"align":["right"]},{"label":["nm_jogo"],"name":[2],"type":["chr"],"align":["left"]},{"label":["thumb"],"name":[3],"type":["chr"],"align":["left"]},{"label":["tp_jogo"],"name":[4],"type":["chr"],"align":["left"]},{"label":["link"],"name":[5],"type":["chr"],"align":["left"]},{"label":["ano_publicacao"],"name":[6],"type":["int"],"align":["right"]},{"label":["ano_nacional"],"name":[7],"type":["int"],"align":["right"]},{"label":["qt_jogadores_min"],"name":[8],"type":["int"],"align":["right"]},{"label":["qt_jogadores_max"],"name":[9],"type":["int"],"align":["right"]},{"label":["vl_tempo_jogo"],"name":[10],"type":["int"],"align":["right"]},{"label":["idade_minima"],"name":[11],"type":["int"],"align":["right"]},{"label":["qt_tem"],"name":[12],"type":["int"],"align":["right"]},{"label":["qt_teve"],"name":[13],"type":["int"],"align":["right"]},{"label":["qt_favorito"],"name":[14],"type":["int"],"align":["right"]},{"label":["qt_quer"],"name":[15],"type":["int"],"align":["right"]},{"label":["qt_jogou"],"name":[16],"type":["int"],"align":["right"]}],"data":[{"1":"2","2":"Ticket to Ride","3":"https://storage.googleapis.com/ludopedia-capas/2_t.jpg","4":"b","5":"https://ludopedia.com.br/jogo/ticket-to-ride","6":"2004","7":"2014","8":"2","9":"5","10":"45","11":"8","12":"4160","13":"494","14":"545","15":"2207","16":"5280"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>A informação que buscaremos extrair da segunda estrutura de dados é àquela associada às colunas que têm o prefixo <code>nm_</code> que contém as <em>strings</em> que definem àquela entidade. Note que em todos esses casos nós estamos interessados em extrair as informações que estão na segunda coluna de cada <code>data.frame</code> e que, portanto, não precisamos focar no nome da coluna em si para ter acesso à elas, apenas na sua posição. Além disso, pode existir mais de um elemento nesta coluna, e precisaremos concatenar estas informações em um <em>string</em> só. Assim, usaremos a função <code><a href="https://purrr.tidyverse.org/reference/keep.html">purrr::keep</a></code> para reter todos os elementos que são um <code>data.frame</code> e, então, extrairemos a segunda coluna de cada uma delas mapeando a função <code>purrr::pull</code>. Finalmente, mapearemos um <code>paste0</code> à cada elemento da lista para concatenar o seu conteúdo a um <em>string</em> só, e usaremos um <code>bind_cols</code> para colocar tudo como um <code>tibble</code>.</p>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># lendo o arquivo JSON com os metadados do jogo</span></span>
<span><span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/read_json.html">read_json</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html">dir_ls</a></span><span class="op">(</span><span class="va">path_para_metadata</span><span class="op">)</span>, simplifyDataFrame <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># retendo apenas os elementos que sao dataframes</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html">keep</a></span><span class="op">(</span><span class="va">is.data.frame</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># pegando a coluna que contem os o nome do metadado</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span>.f <span class="op">=</span> <span class="va">pull</span>, var <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># passando o vetor de strings para um unico string por elemento da lista</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span>.f <span class="op">=</span> <span class="va">paste0</span>, collapse <span class="op">=</span> <span class="st">';'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># juntando os elementos da lista coluna a coluna</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># visualizando a tabela</span></span>
<span>  <span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html">paged_table</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["mecanicas"],"name":[1],"type":["chr"],"align":["left"]},{"label":["categorias"],"name":[2],"type":["chr"],"align":["left"]},{"label":["temas"],"name":[3],"type":["chr"],"align":["left"]},{"label":["artistas"],"name":[4],"type":["chr"],"align":["left"]},{"label":["designers"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"Gerenciamento de Mãos;Construção de Redes e Rotas","2":"Jogo de Entrada","3":"Transportes","4":"Julien Delval;Cyrille Daujean","5":"Alan R. Moon"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Como estes dois passos são baseados no mesmo dado e devem compor o mesmo parser, vamos empacotá-los em uma única função, <code>parser_infos_jogos</code>.</p>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># função para parsear as informações de um jogo</span></span>
<span><span class="va">parser_infos_jogo</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">target_path</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># carregando o arquivo JSON com os metadados do jogo</span></span>
<span>  <span class="va">metadados</span> <span class="op">&lt;-</span> <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/read_json.html">read_json</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">target_path</span>, simplifyDataFrame <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="co"># colocando todos os metadados em um tibble</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="co"># parseando as informacoes que estao organizadas como strings ou numeros</span></span>
<span>    <span class="va">metadados</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="co"># descartando todos os elementos que sao dataframes</span></span>
<span>      <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html">discard</a></span><span class="op">(</span><span class="va">is.data.frame</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="co"># juntando cada elemento da lista coluna a coluna</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="co"># parseando as informacoes que estao organizadas como uma lista de dataframes</span></span>
<span>    <span class="va">metadados</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="co"># retendo apenas os elementos que sao dataframes</span></span>
<span>      <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html">keep</a></span><span class="op">(</span><span class="va">is.data.frame</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="co"># pegando a coluna que contem os o nome do metadado</span></span>
<span>      <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span>.f <span class="op">=</span> <span class="va">pull</span>, var <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="co"># passando o vetor de strings para um unico string por elemento da lista</span></span>
<span>      <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span>.f <span class="op">=</span> <span class="va">paste0</span>, collapse <span class="op">=</span> <span class="st">';'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="co"># juntando os elementos da lista coluna a coluna</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## usando a função para parsear todas as informações</span></span>
<span><span class="fu">parser_infos_jogo</span><span class="op">(</span>target_path <span class="op">=</span> <span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html">dir_ls</a></span><span class="op">(</span><span class="va">path_para_metadata</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># visualizando a tabela completa</span></span>
<span>  <span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html">paged_table</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id_jogo"],"name":[1],"type":["int"],"align":["right"]},{"label":["nm_jogo"],"name":[2],"type":["chr"],"align":["left"]},{"label":["thumb"],"name":[3],"type":["chr"],"align":["left"]},{"label":["tp_jogo"],"name":[4],"type":["chr"],"align":["left"]},{"label":["link"],"name":[5],"type":["chr"],"align":["left"]},{"label":["ano_publicacao"],"name":[6],"type":["int"],"align":["right"]},{"label":["ano_nacional"],"name":[7],"type":["int"],"align":["right"]},{"label":["qt_jogadores_min"],"name":[8],"type":["int"],"align":["right"]},{"label":["qt_jogadores_max"],"name":[9],"type":["int"],"align":["right"]},{"label":["vl_tempo_jogo"],"name":[10],"type":["int"],"align":["right"]},{"label":["idade_minima"],"name":[11],"type":["int"],"align":["right"]},{"label":["qt_tem"],"name":[12],"type":["int"],"align":["right"]},{"label":["qt_teve"],"name":[13],"type":["int"],"align":["right"]},{"label":["qt_favorito"],"name":[14],"type":["int"],"align":["right"]},{"label":["qt_quer"],"name":[15],"type":["int"],"align":["right"]},{"label":["qt_jogou"],"name":[16],"type":["int"],"align":["right"]},{"label":["mecanicas"],"name":[17],"type":["chr"],"align":["left"]},{"label":["categorias"],"name":[18],"type":["chr"],"align":["left"]},{"label":["temas"],"name":[19],"type":["chr"],"align":["left"]},{"label":["artistas"],"name":[20],"type":["chr"],"align":["left"]},{"label":["designers"],"name":[21],"type":["chr"],"align":["left"]}],"data":[{"1":"2","2":"Ticket to Ride","3":"https://storage.googleapis.com/ludopedia-capas/2_t.jpg","4":"b","5":"https://ludopedia.com.br/jogo/ticket-to-ride","6":"2004","7":"2014","8":"2","9":"5","10":"45","11":"8","12":"4160","13":"494","14":"545","15":"2207","16":"5280","17":"Gerenciamento de Mãos;Construção de Redes e Rotas","18":"Jogo de Entrada","19":"Transportes","20":"Julien Delval;Cyrille Daujean","21":"Alan R. Moon"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Pronto! Com isso podemos ter acesso às informações que caracterizam cada um dos jogos de tabuleiro cadastrados no portal da Ludopedia.</p>
</section><section id="outros-usos-da-api" class="level2"><h2 class="anchored" data-anchor-id="outros-usos-da-api">Outros usos da API</h2>
<p>No momento em que escrevo este post, a API da Ludopedia ainda está em fase de desenvolvimento e, portanto, existem algumas funcionalidades que estão previstas mas ainda não foram implementadas. De toda forma, no estado atual dela também podemos ter acesso à uma informação muito interessante: à coleção de jogos de tabuleiro de cada usuário. Este dado é legal pois ele traz coisas como as notas que a pessoa usuária deu à cada jogo, os comentários que a pessoa usuária fez sobre ele, se a pessoa tem ou não aquele jogo e coisas do gênero. Assim, ainda que a API não esteja completa, ela tem muitos outros potenciais de uso para a análise de dados.</p>
<p>Um exemplo de uso daqueles dados poderia ser na criação de algum tipo de sistema de recomendação, uma vez que podemos mapear as notas dadas à cada jogo de tabuleiro por cada um dos usuários. Não é o meu intuito detalhar aqui como usar a API para extrair este tipo de informação, mas podemos ter uma visão bem alto nível através da documentação da API: usamos um <em>endpoint</em> para extrair a coleção de jogos de uma pessoa usuária qualquer através do seu identificador (<em>i.e.</em>, <code>https://ludopedia.com.br/api/v1/colecao</code>); este identificador, por sua vez, pode ser extraído a partir de um outro <em>endpoint</em>, que traz a lista de usuários cadastrados no portal (<em>i.e.</em>, <code>https://ludopedia.com.br/api/v1/usuarios</code>); por fim, temos acesso a um máximo de 100 jogos por vez da coleção de cada pessoa, e precisaremos usar o mesmo método para a paginação das <em>querys</em> para extrair a coleção completa de cada usuário - e é possível determinar o tamanho da coleção de cada usuário diretamente através de um outro <em>endpoint</em> (<em>i.e.</em>, <code>https://ludopedia.com.br/api/v1/colecao/count</code>). É claro que precisaremos aplicar algum tratamento aos dados que a API nos retorna para chegar à estrutura necessária para um sistema de recomendação, mas acredito que dê para pegar a ideia geral aqui.</p>
</section></section><section id="dicionário-de-dados" class="level1"><h1>Dicionário de Dados</h1>
<p>Como a ideia é utilizar os dados dessa API no futuro, vou deixar aqui um dicionário para explicar as informações dos metadados que temos disponíveis - de forma similar ao que fiz para a API do BoardGameGeek.</p>
<ul>
<li>
<strong>id_jogo:</strong> identificador numérico único do jogo;<br>
</li>
<li>
<strong>nm_jogo:</strong> nome do jogo em português;<br>
</li>
<li>
<strong>thumb:</strong> link para a imagem de capa do jogo;<br>
</li>
<li>
<strong>tp_jogo:</strong> indicador do tipo de jogo - jogo base (b) ou expansão (e);<br>
</li>
<li>
<strong>link:</strong> link para a página do jogo dentro do domínio da Ludopedia;<br>
</li>
<li>
<strong>ano_publicacao:</strong> ano de criação do jogo;<br>
</li>
<li>
<strong>ano_nacional:</strong> ano de lançamento do jogo no Brasil - é <code>NA</code> caso o jogo não tenha sido lançado por aqui;<br>
</li>
<li>
<strong>qt_jogadores_min:</strong> quantidade mínima de jogadores necessária para o jogo;<br>
</li>
<li>
<strong>qt_jogadores_max:</strong> quantidade máxima de jogadores sustentada pelo jogo;<br>
</li>
<li>
<strong>vl_tempo_jogo:</strong> duração de uma partida do jogo;<br>
</li>
<li>
<strong>idade_minima:</strong> idade mínima sugerida para o jogo;<br>
</li>
<li>
<strong>qt_tem:</strong> quantidade de usuários que têm o jogo;</li>
<li>
<strong>qt_teve:</strong> quantidade de usuários que já tiveram o jogo;</li>
<li>
<strong>qt_favorito:</strong> quantidade de usuários que têm este jogo como favorito;<br>
</li>
<li>
<strong>qt_quer:</strong> quantidade de usuários que estão em busca do jogo;<br>
</li>
<li>
<strong>qt_jogou:</strong> quantidade de usuários que jogou o jogo;<br>
</li>
<li>
<strong>mecanicas:</strong> nomes da mecânicas de jogo;<br>
</li>
<li>
<strong>categorias:</strong> nome das famílias associadas ao jogo;<br>
</li>
<li>
<strong>temas:</strong> nomes das temáticas associadas ao jogo;<br>
</li>
<li>
<strong>designers:</strong> nome das pessoas do autoras do jogo;<br>
</li>
<li>
<strong>artistas:</strong> nome das pessoas artistas responsáveis pela arte jogo.</li>
</ul></section><section id="conclusões" class="level1"><h1>Conclusões</h1>
<p>Este post focou em demonstrar como interagir com a API da Ludopedia, indo do processo de autenticação, à requisição e o parser dos dados. Focamos exclusivamente nos <em>endpoints</em> para a aquisição dos dados dos jogos de tabuleiro, mas o mesmo processo pode ser utilizado para a aquisição de outros tipos de dados, tais como a lista lista de usuários, suas coleções e informações das partidas. Como vimos através deste exercício, essa API fornece uma forma bastante amigável de acessarmos dados muito relevantes para muitos tipos de análise.</p>
<p>Esta API é bastante diferente daquela oferecidade pelo BoardGameGeek, não só em termos de uso, mas também dos dados fornecidos. Neste contexto, pude notar que os metadados dos jogos de tabuleiro oferecidos pela API da Ludopedia representam um subconjunto daqueles disponíveis na página de cada jogo dentro do próprio portal, assim como daqueles que estão disponíveis através da API do BoardGameGeek. Comparando as informações àquelas no próprio portal, por exemplo, a API da Ludopedia não traz nada sobre as editoras, domínios e nem dependência do idioma. Nesta mesma linha, a API do BoardGameGeek fornece as informações das notas dos jogos junto dos metadados, ao contrário desta API que exploramos. Assim, me parece que ainda há espaço para que ela possa evoluir.</p>
<p>Por fim, o fato da API não fornecer tantas informações como àquelas do BoardGameGeek não é um problema. O principal motivo para isso é que é possível integrar as duas fontes de informação, usando uma para enriquecer a outra - como veremos através das análises de dados que faremos em posts futuros.</p>
</section><section id="possíveis-extensões" class="level1"><h1>Possíveis Extensões</h1>
<p>Acredito que grande parte das extensões que listei no post sobre a API do BoardGameGeek valha para este também - além, é claro, do fato de que várias destas extensões são co-dependentes entre os dois posts. De toda forma, acredito que a principal extensão relacionada especificamente a este post seria a da implementação das funções para acessar os dados de outros <em>endpoints</em>, juntamente com os seus respectivos parsers.</p>
<p>Dúvidas, sugestões ou críticas? É só me procurar pelo e-mail ou GitHub!</p>


</section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> De volta ao topo</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuso</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/deed.pt">https://creativecommons.org/licenses/by/4.0/deed.pt</a></div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citação</h2><div><div class="quarto-appendix-secondary-label">BibTeX</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{marino2022,
  author = {Marino, Nicholas},
  title = {Interagindo com a API da Ludopedia},
  date = {2022-03-25},
  url = {https://nacmarino.netlify.app//posts/2022-03-25_api-ludopedia},
  langid = {pt}
}
</code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">Por favor, cite este trabalho como:</div><div id="ref-marino2022" class="csl-entry quarto-appendix-citeas" role="listitem">
Marino, Nicholas. 2022. <span>“Interagindo com a API da
Ludopedia.”</span> March 25, 2022. <a href="https://nacmarino.netlify.app//posts/2022-03-25_api-ludopedia">https://nacmarino.netlify.app//posts/2022-03-25_api-ludopedia</a>.
</div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("https:\/\/nacmarino\.netlify\.app\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script><script src="https://giscus.app/client.js" data-repo="nacmarino/blog" data-repo-id="R_kgDOKH7ZGw" data-category="Announcements" data-category-id="DIC_kwDOKH7ZG84Cbmfw" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Blog created with <a href="https://quarto.org/">Quarto</a> by Nicholas Marino. License: <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC BY-SA 2.0</a>.</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>